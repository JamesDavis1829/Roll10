@page "/"
@using Roll10.Models
@using Roll10.Components
@inject Roll10.Services.IApiService ApiService
@inject Roll10.Services.GlobalRefreshService GlobalRefreshService


<Toast />
<PopupMenu />
<div class="flex flex-col items-center">
    <div class="lg:w-11/12 w-full">
        @foreach (var character in _characters)
        {
            <CharacterDescription Character="character" AllCharacterActions="_characterActions"></CharacterDescription>
        }
    </div>
</div>

@code{
    private List<Character> _characters = new();
    private List<CharacterAction> _characterActions = new();
    protected override async Task OnInitializedAsync()
    {
        _characters = (await ApiService.GetDefaultCharacters()).ToList();
        _characterActions = await ApiService.GetActions(true);
        GlobalRefreshService.RefreshRequested += StateHasChanged;
    }
}